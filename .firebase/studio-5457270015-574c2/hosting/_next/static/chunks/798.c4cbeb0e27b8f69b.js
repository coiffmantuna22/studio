"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[798],{50798:(e,s,t)=>{t.r(s),t.d(s,{default:()=>N});var a=t(95155),r=t(12115),l=t(66695),n=t(30285),d=t(98328),c=t(63920),i=t(19968),m=t(34548),o=t(65119),u=t(83013),x=t(76959),h=t(46375),f=t(80644),g=t(70831),p=t(91950),j=t(59434);function N(e){let{teachers:s,classes:t,substitutions:N,timeSlots:b,onAssignSubstitute:y}=e,w=function(e){let{teachers:s,classes:t,substitutions:a,timeSlots:l,dateRange:n}=e;return(0,r.useMemo)(()=>{let e=n?(0,f.o)(n.start):(0,f.o)(new Date),r=n?(0,f.o)(n.end):e,d=e=>{if(!e||"string"!=typeof e||!e.includes(":"))return 0;let[s,t]=e.split(":").map(Number);return s+t/60},c=[],i=e;for(;i<=r;){let e=p.B[i.getDay()];s.forEach(s=>{var r;let n=(s.absences||[]).filter(e=>{try{let s="string"==typeof e.date?new Date(e.date):e.date;return(0,x.r)((0,f.o)(s),i)}catch(e){return!1}});0!==n.length&&Object.entries((null==(r=s.schedule)?void 0:r[e])||{}).forEach(e=>{let[r,m]=e,o=Array.isArray(m)?m:m?[m]:[];o&&0!==o.length&&o.forEach(e=>{if(!e||!e.classId)return;let m=l.find(e=>e.start===r);if(m&&n.some(e=>{if(e.isAllDay)return!0;let s=d(m.start),t=d(m.end),a=d(e.startTime);return s<d(e.endTime)&&t>a})){let l=t.find(s=>s.id===e.classId);if(l){let t=(a||[]).some(s=>(0,x.r)((0,f.o)(new Date(s.date)),i)&&s.time===r&&s.classId===e.classId);c.push({...e,date:i,time:r,className:l.name,classId:l.id,absentTeacherName:s.name,absentTeacherId:s.id,isCovered:t})}}})})}),i=(0,g.f)(i,1)}return c},[s,t,a,l,n])}({teachers:s,classes:t,substitutions:N,timeSlots:b,dateRange:(0,r.useMemo)(()=>{let e=new Date;return{start:(0,m.k)(e,{weekStartsOn:0}),end:(0,o.$)(e,{weekStartsOn:0})}},[])}),v=(0,r.useMemo)(()=>w.filter(e=>!e.isCovered).sort((e,s)=>e.date.getTime()-s.date.getTime()||e.time.localeCompare(s.time)),[w]);if(0===v.length)return null;let E=(0,r.useMemo)(()=>{let e={};return v.forEach(s=>{let t=(0,u.GP)(s.date,"yyyy-MM-dd");e[t]||(e[t]=[]),e[t].push(s)}),e},[v]);return(0,a.jsxs)(l.Zp,{className:"border-l-4 border-l-orange-500 shadow-md",children:[(0,a.jsxs)(l.aR,{className:"pb-3",children:[(0,a.jsxs)(l.ZB,{className:"text-xl flex items-center gap-2",children:[(0,a.jsx)(d.A,{className:"text-orange-500 h-5 w-5"}),"שיעורים הדורשים החלפה השבוע"]}),(0,a.jsx)(l.BT,{children:"רשימת השיעורים שעדיין לא נמצא להם מחליף לשבוע הקרוב."})]}),(0,a.jsx)(l.Wu,{children:(0,a.jsx)("div",{className:"space-y-6",children:Object.entries(E).map(e=>{let[s,t]=e,r=new Date(s),l=(0,x.r)(r,new Date);return(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h3",{className:(0,j.cn)("font-semibold text-sm flex items-center gap-2",l?"text-orange-600":"text-muted-foreground"),children:[(0,a.jsx)("span",{className:"w-2 h-2 rounded-full bg-current"}),(0,u.GP)(r,"EEEE, d בMMMM",{locale:h.he}),l&&(0,a.jsx)("span",{className:"text-xs bg-orange-100 text-orange-700 px-2 py-0.5 rounded-full mr-2",children:"היום"})]}),(0,a.jsx)("div",{className:"grid gap-3 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3",children:t.map((e,t)=>(0,a.jsxs)("div",{className:"flex flex-col p-3 bg-secondary/30 rounded-lg border hover:bg-secondary/50 transition-colors",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsx)("span",{className:"font-medium",children:e.className}),(0,a.jsx)("span",{className:"text-xs font-mono bg-background px-1.5 py-0.5 rounded border",children:e.time})]}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground mb-3",children:[(0,a.jsx)("div",{children:e.subject}),(0,a.jsxs)("div",{className:"text-xs mt-1 flex items-center gap-1",children:[(0,a.jsx)(c.A,{className:"h-3 w-3"}),e.absentTeacherName]})]}),y&&(0,a.jsxs)(n.$,{variant:"outline",size:"sm",className:"mt-auto w-full text-xs h-8",onClick:()=>y(e),children:["שבץ מחליף",(0,a.jsx)(i.A,{className:"mr-1 h-3 w-3"})]})]},"".concat(s,"-").concat(t)))})]},s)})})})]})}}}]);